<%= render 'category_dropdown' %>

<% @data.vendors.each_with_index do |vendor, index| %>
  <div class="row rounded text-white p-4 m-4 <%= repeat_colors_by_index(index) %>">

    <% if can_edit?(vendor) %>
      <div class="row">
        <% if @data.page_name == 'Unapproved Listings' %>
          <div class="col d-flex justify-content-start">
            <h3 class="text-white">Vendor Category: <%= Vendor::CATEGORIES[vendor.category.to_sym] %></h3>
          </div>
        <% end %>

        <div class="col d-flex justify-content-end">
          <%= link_to edit_vendor_path(vendor.id) do %>
            <button type="button" class="btn btn-primary m-2">Edit</button>
          <% end %>

          <% if @data.page_name == 'Unapproved Listings' %>
            <%= form_with(model: vendor, local: true, method: :patch, class: "d-inline") do |form| %>
              <%= form.hidden_field :approved, value: true %>
              <%= form.submit "Approve", class: "btn btn-success m-2" %>
            <% end %>
          <% end %>

          <%= form_with(model: vendor, local: true, method: :patch, class: "d-inline") do |form| %>
            <%= form.hidden_field :archived, value: true %>
            <%= form.submit "Archive", class: "btn btn-danger m-2" %>
          <% end %>
        </div>
      </div>
    <% end %>

    <div class="row p-3">
      <div class="col-lg-3">
        <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
          <div>
            <% vendor.uploads.each_with_index do |image, index| %>
              <div class="carousel-item <%= 'active' if index == 0 %>">
                <%= image_tag(image.s3_url(size: 'small'), class: "d-block w-100", alt: "...") %>
              </div>
            <% end %>

            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <!-- TODO REMOVE STOCK PHOTOS! -->
            <% if vendor.uploads.none? %>
              <% images = %w( res-1.jpeg res-2.jpeg res-3.jpeg res-4.jpeg res-5.jpeg res-6.jpeg res-7.jpeg res-8.jpeg res-9.jpeg res-10.jpeg) %>
              <% 3.times do |n| %>
                <div class="carousel-item <%= 'active' if n == 0 %>">
                  <%= image_tag(images.sample, class: "d-block w-100", alt: "...") %>
                </div>
              <% end %>
            <% end %>

          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
      </div>
      <div class="col-lg-9">
        <div class="px-3">
          <h2 class="text-white display-5"><%= vendor.name %></h2>
          <p><%= vendor.description %></p>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-3">
        <%= image_tag('stock_logo.png', class: 'dblock w-100') %>
      </div>
      <div class="col-lg-3">
        <div class="p-3">
          <h3 class="text-white">Cuisine</h3>
          <div class="d-flex flex-column gap-2">
            <% vendor.tags.each do |tag| %>
              <a href="#" class="btn btn-outline-secondary btn-sm text-white"><%= tag.name %></a>
            <% end %>
          </div>
        </div>
      </div>
      <div class="col-lg-3">
        <div class="p-3">
          <h3 class="text-white">Contact Info</h3>
          <p>Phone: <%= vendor.phone %></p>
          <p>Email: <%= vendor.email %></p>
        </div>
      </div>
      <div class="col-lg-3">
        <div class="p-3">
          <h3 class="text-white">Location</h3>
          <%= vendor.address %>
        </div>
      </div>
    </div>
  </div>
  <hr>
<% end %>